{% extends "main/base.html" %}
{% load static %}
{% load humanize %}
{% load i18n %}


{% block title %} Я ЕМ с {{client.name}} {% endblock title %}

{% block content %}

<!--button up-->
<a id="scrollToTopButton" class="btn fs-5 bg-dark mx-2 shadow"
   style="color: #fd7014; --bs-bg-opacity: .8; border-radius: 50px; position: fixed; bottom: 100px; right: 50px; display: none;"
   href="#header">
    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-arrow-up"
         viewBox="0 0 16 16">
        <path fill-rule="evenodd"
              d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
    </svg>
</a>
<!--button end-->

<main>
    <!--  MAIN CONTENT  -->
    <section class="skrollable pb-5"
             style="background-image: linear-gradient(0deg, rgba(51, 51, 51, 0.7), rgba(51, 51, 51, 1)), url({% static 'images/3.jpg' %});
    background-attachment: fixed; background-position: 50% 50%; background-repeat: repeat">

        <!--Flying Cart-->
        <a id="Cart" class="btn fs-5 bg-dark mx-2 shadow btn-animate"
           style="color: #fd7014; --bs-bg-opacity: .8; border-radius: 50px; position: fixed; bottom: 30px; right: 50px; display: none"
           href="{% url 'cart:cart_page' %}">
            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-cart3"
                 viewBox="0 0 16 16">
                <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l.84 4.479 9.144-.459L13.89 4H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
            </svg>
        </a>
        <!--    CAFE DESCRIPTION    -->
        <div class="container-fluid pt-4">
            <div class="col-lg-12 bg-dark text-center"
                 style="--bs-bg-opacity: .7; border-radius: 50px;">
                <div class="row">
                    <div class="col-4">
                        <img src="/{{client.logo}}" alt="" height="200px" width="auto" class="my-4"
                             style="border-radius: 15px;">
                    </div>

                    <div class="col-7 content">
                        <h4 class="text-start ms-5">
                            Добро пожаловать в {{ client.name }}
                            <a href="{{ client.inst }}">
                                <div class="btn btn-success ms-5 btn-animate" style="border-radius: 20px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                                         class="bi bi-instagram" viewBox="0 0 16 16">
                                        <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"/>
                                    </svg>
                                </div>
                            </a>
                        </h4>


                        <p class="text-start ms-2 my-1 fst-italic text-body">Время работы: {{ client.working_time }}</p>
                        <p class="text-start ms-2 my-1 text-body">г.{{client.city}}, {{client.address}}; Телефон:
                            {{client.phone}}</p>
                        <p class="text-start ms-2 my-2">{{ client.description }}</p>
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-sm-2">
                                    <p class="text-start mt-0 text-body">{% trans 'Самовывоз' %}:</p>
                                    <p class="text-start my-0 text-body">{% trans 'Доставка' %}:</p>
                                </div>
                                <div class="col-3">
                                    <p class="text my-0">
                                        {% if client.outside %}
                                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25"
                                             fill="currentColor"
                                             class="bi bi-check text-light bg-success mt-0" viewBox="0 0 16 16"
                                             style="border-radius: 25px;">
                                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                                        </svg>
                                        {% else %}
                                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="white"
                                             class="bi bi-x bg-danger mt-0" viewBox="0 0 16 16"
                                             style="border-radius: 25px;">
                                            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                                        </svg>
                                        {% endif %}
                                    </p>
                                    <p class="">
                                        {% if client.delivery %}
                                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25"
                                             fill="currentColor"
                                             class="bi bi-check text-light bg-success my-3" viewBox="0 0 16 16"
                                             style="border-radius: 25px;"> viewBox="0 0 16 16">
                                            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
                                        </svg>
                                        {% else %}
                                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="white"
                                             class="bi bi-x bg-danger my-3" viewBox="0 0 16 16"
                                             style="border-radius: 25px;">
                                            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                                        </svg>
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <h2 class="text-center pt-4 fw-bold" style="color: #fd7014">{% trans 'МЕНЮ' %}</h2>

        <!--    FOOD TYPE SWIPER    -->
        <div class="sticky-top">
            <div class="container-fluid text-center bg-dark" style="--bs-bg-opacity: 0.5; overflow-x: hidden;">
                <div class="row">
                    <div class="col-12">
                        <div class="swiper-container">
                            <div class="swiper-wrapper">
                                {% for ft in food_type %}
                                <div class="swiper-slide">
                                    <a class="btn fs-5 bg-dark mx-2 shadow btn-animate"
                                       style="color: #fd7014; --bs-bg-opacity: .8; border-radius: 50px;"
                                       href="#{{ ft }}">{{ ft }}</a>
                                </div>
                                {% endfor %}
                            </div>
                            <div class="swiper-button-next"></div>
                            <div class="swiper-button-prev"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
        <script src="{% static 'js/swiper.js' %}"></script>
        <script>
  var prevScrollPos = window.pageYOffset || document.documentElement.scrollTop;
  var categoriesContainer = document.querySelector('.sticky-top');

  window.addEventListener('scroll', function() {
    var currentScrollPos = window.pageYOffset || document.documentElement.scrollTop;

    if (currentScrollPos > prevScrollPos && currentScrollPos > 510) {

      categoriesContainer.classList.remove('show');
      categoriesContainer.classList.add('hide');
    } else {

      categoriesContainer.classList.remove('hide');
      categoriesContainer.classList.add('show');
    }

    prevScrollPos = currentScrollPos;
  });

        </script>
        <style>
  .sticky-top {
    opacity: 1;
    transition: opacity 0.3s;
  }

  .hide {
    opacity: 0;
  }

  .show {
    opacity: 1;
  }

        </style>
        <!--    FOOD TYPE SWIPER    -->

        <!--    FOOD TYPE DOWN    -->
        {% for ft in food_type %}
        <h2 class="ms-5 mt-5" style="color: #fd7014" id="{{ ft }}">{{ ft }}</h2>

        <!--    DISH CONTENT    -->
        <div class="container-fluid my-3">
            <div class="row gy-3 mx-auto justify-content-center">
                {% for dish in dishes %}
                {% if dish.food_type == ft and dish.stop == False %}
                <div class="col-lg-5 bg-dark col-sm-12 mx-1"
                     style="--bs-bg-opacity: .7; border-radius: 50px;">
                    <div class="row">

                        <div class="col-lg-9 col-sm-9 text-start ps-5">
                            <h5 class="mb-0 fw-bold">{{ dish.name }}</h5>
                            <p class=" fs-6">{{ dish.description }}</p>
                        </div>
                        <div class="col-lg-3 col-sm-3 text-center">
                            {% if dish.old_price > dish.actual_price %}
                            <del class="fs-4 text-danger">
                                <p class="my-0" style="color: #fd7014">{{ dish.old_price|intcomma }}</p></del>
                            {% endif %}
                            <p class="my-0 fs-4 fw-bold" style="color: #fd7014">{{ dish.actual_price|intcomma }}
                                ₸</p>

                            <!--       Add to cart form       -->
                            <form class="add-to-cart-form" action="{% url 'cart:add_to_cart' %}" method="post">
                                {% csrf_token %}
                                <input type="hidden" name="product_id" value="{{ dish.id }}">
                                <input type="hidden" name="quantity" value="1" style="width: 50px">
                                <button class="btn btn-success my-1 btn-animate" type="submit"
                                        style="--bs-btn-active-bg: #fd7014;" data-bs-toggle="modal"
                                        data-bs-target="#exampleModal">
                                    Добавить
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </section>

    <!--  MODAL CART WINDOW  -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title ms-5" id="exampleModalLabel">{% trans 'Добавлено в корзину' %}</h5>
                    <button class="btn-close" data-bs-dismiss="modal" aria-label="close"></button>
                </div>
            </div>
        </div>
    </div>
</main>

{% endblock content %}

